<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Star Jasmine Watering Calculator</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071028 0%, #081827 100%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));backdrop-filter: blur(6px);border-radius:14px;padding:22px;max-width:760px;width:100%;box-shadow:0 8px 30px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.03)}
    h1{font-size:18px;margin:0 0 8px}
    p.lead{margin:0 0 18px;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=number], select, input[type=range]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:14px}
    .full{grid-column:1/-1}
    .row{display:flex;gap:8px}
    button{background:linear-gradient(90deg,var(--accent),#3b82f6);color:#04203a;border:none;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    .result{margin-top:16px;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.02)}
    .muted{color:var(--muted);font-size:13px}
    .highlight{background:linear-gradient(90deg,rgba(96,165,250,0.15),rgba(59,130,246,0.15));padding:12px;border-radius:8px;margin-top:10px;border:1px solid rgba(96,165,250,0.2)}
    footer{margin-top:14px;color:var(--muted);font-size:13px}
    .tooltip{font-size:12px;color:var(--muted);margin-top:4px;font-style:italic}
    @media (max-width:720px){.grid{grid-template-columns:1fr}.row{flex-direction:column}}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Star Jasmine Watering Calculator</h1>
    <p class="lead">Calculates optimal watering schedule based on pot size, plant height, and environmental conditions.</p>

    <div class="grid">
      <div>
        <label for="potDiameter">Pot diameter (cm)</label>
        <input id="potDiameter" type="number" min="10" max="50" step="1" value="30" />
        <div class="tooltip">Inner diameter of the pot</div>
      </div>
      <div>
        <label for="length">Plant height (cm)</label>
        <input id="length" type="number" min="5" step="1" value="30" />
        <div class="tooltip">Tallest trained height</div>
      </div>
      <div>
        <label for="temp">Temperature (¬∞C)</label>
        <input id="temp" type="number" min="15" max="35" step="1" value="20" />
      </div>
      <div>
        <label for="season">Season</label>
        <select id="season">
          <option value="summer">Summer (active)</option>
          <option value="winter">Winter (dormant)</option>
        </select>
      </div>
      <div>
        <label for="rh">Relative Humidity (RH) ‚Äî %</label>
        <input id="rh" type="range" min="10" max="90" step="1" value="45" />
        <div id="rhVal" class="muted">45%</div>
      </div>
      <div>
        <label for="light">Light Exposure</label>
        <select id="light">
          <option value="0.7">Low (north window)</option>
          <option value="1.0" selected>Medium (east/west window)</option>
          <option value="1.4">Bright (south window/direct)</option>
        </select>
      </div>
      <div>
        <label for="evap">Evaporation rate (mm/day)</label>
        <select id="evap">
          <option value="1">Low (1 mm/day)</option>
          <option value="1.5" selected>Moderate (1.5 mm/day)</option>
          <option value="3">High (3 mm/day)</option>
        </select>
      </div>
      <div>
        <label for="reservoir">Reservoir size (liters)</label>
        <input id="reservoir" type="number" min="1" step="0.5" value="15" />
      </div>
      <div>
        <label for="mlPerWatering">Water per watering (mL)</label>
        <input id="mlPerWatering" type="number" min="10" step="5" value="105" />
        <div class="tooltip">Amount delivered each cycle</div>
      </div>
      <div class="full row">
        <button id="calc">Calculate Watering Schedule</button>
        <button id="reset" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);">Reset</button>
      </div>
    </div>

    <section class="result" aria-live="polite">
      <div id="outputTitle" style="font-weight:700">Watering Schedule</div>
      <div id="results" style="margin-top:8px">Enter values and press Calculate.</div>
      <div style="margin-top:10px" class="muted">Formula: <code id="formula"></code></div>
    </section>

    <footer>
      <div class="muted"><strong>Watering Tip:</strong> Star Jasmine prefers soil to dry out between waterings. Water when the top inch of soil feels dry to the touch. This calculator provides estimates - always monitor soil moisture and adjust as needed.</div>
    </footer>
  </main>

  <script>
    const HOURS_PER_WEEK = 168;

    const potDiameterEl = document.getElementById('potDiameter');
    const lengthEl = document.getElementById('length');
    const tempEl = document.getElementById('temp');
    const seasonEl = document.getElementById('season');
    const rhEl = document.getElementById('rh');
    const rhVal = document.getElementById('rhVal');
    const lightEl = document.getElementById('light');
    const evapEl = document.getElementById('evap');
    const reservoirEl = document.getElementById('reservoir');
    const mlPerWateringEl = document.getElementById('mlPerWatering');
    const results = document.getElementById('results');
    const calcBtn = document.getElementById('calc');
    const resetBtn = document.getElementById('reset');
    const formulaEl = document.getElementById('formula');

    rhEl.addEventListener('input', ()=> rhVal.textContent = rhEl.value + '%');

    function clamp(v,a,b){return Math.min(b,Math.max(a,v));}

    function computePlantWater(potDiameter, plantHeight, season, RH, temperature, lightFactor){
      // Calculate pot surface area (cm¬≤)
      const potRadius = potDiameter / 2;
      const potArea = Math.PI * potRadius * potRadius;
      
      // Base water needs per cm¬≤ of pot surface per week (mL/cm¬≤/week)
      // Calibrated to real-world needs
      const baseWaterPerCm2 = {
        summer: 0.60,  // ~425 mL/week for 30cm pot at defaults
        winter: 0.32   // ~225 mL/week for 30cm pot at defaults
      };
      
      // Start with pot-area-based calculation
      const baseWater = baseWaterPerCm2[season] * potArea;
      
      // Plant height scaling factor (smaller impact than pot size)
      // Uses exponent of 0.5 to give moderate scaling
      const heightScale = Math.pow(plantHeight / 30, 0.5);
      
      // Temperature factor: exponential relationship
      // At 20¬∞C: 1.0x, at 25¬∞C: 1.28x, at 30¬∞C: 1.63x
      const tempFactor = Math.pow(1.05, temperature - 20);
      
      // Refined humidity adjustment (non-linear)
      // Lower RH = more evaporation = more water needed
      const humidityFactor = 1 + 0.015 * (50 - RH);
      
      // Combine all factors
      const weekly = baseWater * heightScale * tempFactor * humidityFactor * lightFactor;
      
      return {
        weekly,
        potArea,
        heightScale,
        tempFactor,
        humidityFactor,
        lightFactor
      };
    }

    function reservoirSurfaceArea(liters){
      const m3 = liters / 1000;
      const d = Math.pow((4 * m3) / Math.PI, 1/3);
      const area = Math.PI * Math.pow(d/2, 2);
      return area;
    }

    calcBtn.addEventListener('click', ()=>{
      const potDiameter = Number(potDiameterEl.value);
      const plantHeight = Number(lengthEl.value);
      const temperature = Number(tempEl.value);
      const season = seasonEl.value;
      const RH = clamp(Number(rhEl.value), 0, 100);
      const lightFactor = Number(lightEl.value);
      const evapRate = Number(evapEl.value);
      const reservoirLiters = Math.max(Number(reservoirEl.value), 0.1);
      const mlPerWatering = Number(mlPerWateringEl.value);

      if(!potDiameter || potDiameter <= 0){
        results.innerHTML = '<span style="color:#fca5a5">Enter a valid pot diameter.</span>';
        return;
      }
      if(!plantHeight || plantHeight <= 0){
        results.innerHTML = '<span style="color:#fca5a5">Enter a valid plant height.</span>';
        return;
      }
      if(!mlPerWatering || mlPerWatering <= 0){
        results.innerHTML = '<span style="color:#fca5a5">Enter a valid water amount per watering.</span>';
        return;
      }

      const plant = computePlantWater(potDiameter, plantHeight, season, RH, temperature, lightFactor);

      const A = reservoirSurfaceArea(reservoirLiters);
      const evapDaily = evapRate * A * 1000;
      const evapWeekly = evapDaily * 7;

      // Calculate watering schedule
      const wateringsPerWeek = plant.weekly / mlPerWatering;
      const intervalHours = HOURS_PER_WEEK / wateringsPerWeek;
      const intervalDays = intervalHours / 24;

      // Calculate reservoir duration (plant consumption + evaporation)
      const totalWeeklyLoss = plant.weekly + evapWeekly;
      const reservoirML = reservoirLiters * 1000;
      const weeksUntilEmpty = reservoirML / totalWeeklyLoss;

      const fmt = n => Math.round(n);

      // Validation warnings
      let warnings = '';
      if(plant.weekly < 200) {
        warnings = '<div style="color:#fbbf24;margin-top:8px">‚ö†Ô∏è Warning: Calculated water needs seem low. Check your inputs.</div>';
      }
      if(plant.weekly > 3000) {
        warnings = '<div style="color:#fbbf24;margin-top:8px">‚ö†Ô∏è Warning: Calculated water needs seem very high. Verify pot size and conditions.</div>';
      }

      results.innerHTML = `
        <div><strong>Plant Water Needs:</strong> ${fmt(plant.weekly)} mL/week</div>
        <div class="muted" style="font-size:12px;margin-top:4px">
          Pot area: ${fmt(plant.potArea)} cm¬≤ | Height factor: ${plant.heightScale.toFixed(2)}x | 
          Temp factor: ${plant.tempFactor.toFixed(2)}x | Humidity factor: ${plant.humidityFactor.toFixed(2)}x | 
          Light factor: ${plant.lightFactor.toFixed(2)}x
        </div>
        
        <div class="highlight">
          <div style="font-size:15px;font-weight:700;margin-bottom:8px">üíß WATERING SCHEDULE</div>
          <div style="font-size:16px;font-weight:700;color:var(--accent)">Water ${mlPerWatering} mL every ${intervalHours.toFixed(1)} hours</div>
          <div style="margin-top:6px;font-size:13px;color:var(--muted)">
            (${wateringsPerWeek.toFixed(1)} times/week √ó ${mlPerWatering} mL = ${fmt(wateringsPerWeek * mlPerWatering)} mL/week)
          </div>
          <div style="margin-top:8px;font-size:12px;color:#fbbf24">
            üí° Water when top inch of soil feels dry, approximately every ${Math.round(intervalDays)} days (${Math.round(intervalHours)} hours)
          </div>
        </div>
        
        <div style="margin-top:12px"><strong>Reservoir Refill Schedule:</strong></div>
        <div>‚Ä¢ Reservoir evaporation: ${fmt(evapWeekly)} mL/week (${evapRate} mm/day)</div>
        <div>‚Ä¢ Total weekly loss (plant + evaporation): ${fmt(totalWeeklyLoss)} mL/week</div>
        <div>‚Ä¢ ${reservoirLiters} L reservoir lasts approximately <strong>${weeksUntilEmpty.toFixed(1)} weeks</strong></div>
        ${warnings}
      `;

      formulaEl.textContent = `Weekly = PotArea √ó HeightScale^0.5 √ó TempFactor^(T-20) √ó HumidityAdj √ó LightFactor √ó BaseSeasonal | Interval = ${mlPerWatering}mL per ${intervalHours.toFixed(1)} hours`;
    });

    resetBtn.addEventListener('click', ()=>{
      potDiameterEl.value = 30;
      lengthEl.value = 30; 
      tempEl.value = 20;
      seasonEl.value = 'summer'; 
      rhEl.value = 45; 
      rhVal.textContent = '45%'; 
      lightEl.value = 1.0;
      evapEl.value = 1.5; 
      reservoirEl.value = 15; 
      mlPerWateringEl.value = 105;
      results.innerHTML = 'Enter values and press Calculate.'; 
      formulaEl.textContent = '';
    });

    calcBtn.click();
  </script>
</body>
</html>
